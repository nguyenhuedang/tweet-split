<!DOCTYPE html><html><head><meta charset="UTF-8"><title>iron-localstorage-basic</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
    <script>if (!window.customElements) { document.write('<!--'); }</script>
    <script type="text/javascript" src="../../webcomponentsjs/custom-elements-es5-adapter.js"></script>
    <!--! do not remove -->
<script src="../../webcomponentsjs/webcomponents-lite.js"></script><script src="../../web-component-tester/browser.js"></script><link rel="import" href="../iron-localstorage.html"></head><body><test-fixture id="fixture"><template><iron-localstorage id="localstorage" name="iron-localstorage-test"></iron-localstorage></template></test-fixture><test-fixture id="nameless"><template><iron-localstorage id="localstorage"></iron-localstorage></template></test-fixture><dom-bind><template id="boundTemplate" is="dom-bind"><iron-localstorage id="boundLocal" name="iron-localstorage-test" value="{{value}}"></iron-localstorage></template></dom-bind><script>var storage,nameless;suite('basic',function(){setup(function(){window.localStorage.setItem('iron-localstorage-test','{"foo":"bar"}'),storage=document.getElementById('fixture').create(),nameless=document.getElementById('nameless').create(),document.getElementById('nameless').restore(),storage.flushDebouncer('reload')}),teardown(function(){window.localStorage.removeItem('iron-localstorage-test')}),test('load',function(){assert.isNotNull(storage.value),assert.equal(storage.value.foo,'bar')}),test('save',function(){var a={foo:'zot'};storage.value=a,storage.flushDebouncer('save');var b=window.localStorage.getItem(storage.name);b=JSON.parse(b),assert.equal(b.foo,a.foo)}),test('delete',function(){storage.value=null,storage.flushDebouncer('save');var a=window.localStorage.getItem(storage.name);assert.isNull(a),storage.value=void 0,storage.flushDebouncer('save');var a=window.localStorage.getItem(storage.name);assert.isNull(a)}),test('event iron-localstorage-load',function(a){nameless.addEventListener('iron-localstorage-load',function(){a()}),nameless.name='iron-localstorage-test'}),test('event iron-localstorage-load-empty',function(a){window.localStorage.removeItem('iron-localstorage-test'),nameless.addEventListener('iron-localstorage-load-empty',function(){nameless.value='Yo',nameless.flushDebouncer('save'),assert.equal('Yo',JSON.parse(window.localStorage.getItem('iron-localstorage-test'))),a()}),nameless.name='iron-localstorage-test'}),test('auto-save sub-properties',function(){var a=document.querySelector('#boundTemplate'),b=document.querySelector('#boundLocal'),c={foo:'FOO',bar:'BAR'};Polymer.Element&&(a.value=c,a=a.parentNode),a.value=c,assert.equal('FOO',b.value.foo),b.flushDebouncer('save'),a.value.foo='Yo',b.flushDebouncer('save');var d=JSON.parse(window.localStorage.getItem('iron-localstorage-test'));assert.notEqual('Yo',d.foo),a.set('value.foo','BAZ!'),b.flushDebouncer('save');var d=JSON.parse(window.localStorage.getItem('iron-localstorage-test'));assert.equal('BAZ!',d.foo),b.value=null})});</script></body></html>