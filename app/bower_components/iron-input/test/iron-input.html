<!DOCTYPE html><html><head><title>iron-input tests</title><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,user-scalable=yes">
    <script>if (!window.customElements) { document.write('<!--'); }</script>
    <script type="text/javascript" src="../../webcomponentsjs/custom-elements-es5-adapter.js"></script>
    <!--! do not remove -->
<script src="../../webcomponentsjs/webcomponents-lite.js"></script><script src="../../web-component-tester/browser.js"></script><link rel="import" href="../iron-input.html"><link rel="import" href="letters-only.html"><link rel="import" href="disabled-input.html"></head><body><test-fixture id="basic"><template><iron-input><input></iron-input></template></test-fixture><test-fixture id="programmatic"><template><iron-input></iron-input></template></test-fixture><test-fixture id="has-bind-value"><template><iron-input bind-value="foobar"><input></iron-input></template></test-fixture><test-fixture id="prevent-invalid-input"><template><iron-input allowed-pattern="[0-9]"><input></iron-input></template></test-fixture><test-fixture id="prevent-invalid-input-has-value"><template><iron-input allowed-pattern="[0-9]"><input value="foobar"></iron-input></template></test-fixture><test-fixture id="prevent-invalid-input-has-bind-value"><template><iron-input allowed-pattern="[0-9]" bind-value="foobar"><input></iron-input></template></test-fixture><test-fixture id="automatically-prevent-invalid-input-if-allowed-pattern"><template><iron-input allowed-pattern="[0-9]"><input></iron-input></template></test-fixture><test-fixture id="basic-validation"><template><iron-input><input pattern="[a-zA-Z]{3}[0-9]*"></iron-input></template></test-fixture><test-fixture id="has-validator"><template><letters-only></letters-only><iron-input validator="letters-only"><input pattern="[0-9]*"></iron-input></template></test-fixture><test-fixture id="native-and-custom-validator"><template><letters-only></letters-only><iron-input validator="letters-only"><input pattern="[a-c]*"></iron-input></template></test-fixture><dom-bind id="bind-to-object"><template is="dom-bind" id="bind-to-object-template"><iron-input id="input" bind-value="{{foo}}"><input></iron-input></template></dom-bind><test-fixture id="disabled"><template><disabled-input></disabled-input></template></test-fixture><script>function fireNativeInputEvent(a){var b=new Event('input',{bubbles:!0,cancelable:!0,composed:!0});a.dispatchEvent(b)}suite('basic',function(){test('can initialize programmatically',function(a){var b=fixture('programmatic');assert.isNull(b.querySelector('input')),Polymer.dom(b).appendChild(document.createElement('input')),Polymer.Base.async(function(){var c=b.querySelector('input');assert.ok(c),assert.ok(b.inputElement),b.bindValue='foobar',assert.equal(c.value,b.bindValue,'input value equals to iron-input bindValue'),c.value='foo',fireNativeInputEvent(c),assert.equal(c.value,b.bindValue,'input value equals to iron-input bindValue'),a()},1)}),test('setting bindValue sets value',function(a){var b=fixture('basic');Polymer.Base.async(function(){var c=b.querySelector('input');b.bindValue='foobar',assert.equal(c.value,b.bindValue,'input value equals to iron-input bindValue'),a()},1)}),test('changing the input triggers an event',function(a){var b=fixture('basic');Polymer.Base.async(function(){var c=b.querySelector('input');b.addEventListener('bind-value-changed',function(){assert.equal(c.value,b.bindValue,'input value equals to iron-input bindValue'),a()}),c.value='foo',fireNativeInputEvent(c)},1)}),test('default bindValue sets value',function(a){var b=fixture('has-bind-value');Polymer.Base.async(function(){var c=b.querySelector('input');assert.equal(b.bindValue,c.value,'input value equals to iron-input bindValue'),a()},1)}),test('set bindValue to undefined',function(){var a=document.getElementById('bind-to-object'),b=document.getElementById('bind-to-object-template'),c=a.$?a:b;c.foo=void 0;var d=c.$.input,e=d.querySelector('input');assert.ok(!d.bindValue,'ironInput bindValue is falsy'),assert.ok(!e.value,'input value is falsy')}),test('set bindValue to false',function(){var a=document.getElementById('bind-to-object'),b=document.getElementById('bind-to-object-template'),c=a.$?a:b;c.foo=!1;var d=c.$.input,e=d.querySelector('input');assert.isFalse(d.bindValue),assert.equal(e.value,'false')}),test('prevent invalid input works after an input event',function(a){var b=fixture('prevent-invalid-input');Polymer.Base.async(function(){var c=b.querySelector('input');c.value='123',fireNativeInputEvent(c),assert.equal(b.bindValue,'123'),c.value='123foo',fireNativeInputEvent(c),assert.equal(b.bindValue,'123'),a()},1)}),test('inputs can be validated',function(a){var b=fixture('basic-validation');Polymer.Base.async(function(){var c=b.querySelector('input');c.value='123',fireNativeInputEvent(c),assert.equal(b.bindValue,'123'),b.validate(),assert.isTrue(b.invalid,'input is invalid'),c.value='foo',fireNativeInputEvent(c),assert.equal(b.bindValue,'foo'),b.validate(),assert.isFalse(b.invalid,'input is valid'),c.value='foo123',fireNativeInputEvent(c),assert.equal(b.bindValue,'foo123'),b.validate(),assert.isFalse(b.invalid,'input is valid'),a()},1)}),test('validator used instead of constraints api if provided',function(a){var b=fixture('has-validator')[1];Polymer.Base.async(function(){var c=b.querySelector('input');c.value='123',fireNativeInputEvent(c),b.validate(),assert.isTrue(b.invalid,'input is invalid'),a()},1)}),test('browser validation beats custom validation',function(a){var b=fixture('native-and-custom-validator')[1];Polymer.Base.async(function(){var c=b.querySelector('input');c.value='aaaa',fireNativeInputEvent(c),b.validate(),assert.isFalse(b.invalid,'input is valid'),c.value='zzz',fireNativeInputEvent(c),b.validate(),assert.isTrue(b.invalid,'input is invalid'),a()},1)}),test('prevent invalid input works automatically when allowed pattern is set',function(a){var b=fixture('automatically-prevent-invalid-input-if-allowed-pattern');Polymer.Base.async(function(){var c=b.querySelector('input');c.value='123',fireNativeInputEvent(c),assert.equal(b.bindValue,'123'),c.value='123foo',fireNativeInputEvent(c),assert.equal(b.bindValue,'123'),b.allowedPattern='',c.value='#123foo BAR!',fireNativeInputEvent(c),assert.equal(b.bindValue,'#123foo BAR!'),b.allowedPattern='[a-zA-Z]',c.value='foo',fireNativeInputEvent(c),c.value='bar123',fireNativeInputEvent(c),assert.equal(b.bindValue,'foo'),a()},1)}),test('disabled input doesn\'t throw on Firefox',function(){var a=fixture('disabled'),b=a.$.input,c=b.querySelector('input');assert.equal(b.bindValue,'foo'),assert.isFalse(a.myInvalid),assert.isTrue(c.disabled)})}),suite('a11y',function(){test('announces invalid characters after an input event',function(a){var b=fixture('prevent-invalid-input');Polymer.Base.async(function(){var c=b.querySelector('input');b.addEventListener('iron-announce',function(d){assert.equal(d.detail.text,'Invalid string of characters not entered.')}),c.value='foo',fireNativeInputEvent(c),a()},1)}),test('announces invalid characters on keypress',function(){var a=fixture('prevent-invalid-input'),b=a.querySelector('input');a.addEventListener('iron-announce',function(d){assert.equal(d.detail.text,'Invalid character a not entered.')});var c=new CustomEvent('keypress',{bubbles:!0,cancelable:!0});c.charCode=97,b.dispatchEvent(c)})});</script></body></html>