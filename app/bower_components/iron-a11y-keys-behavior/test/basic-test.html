<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,user-scalable=yes"><title>iron-a11y-keys</title>
    <script>if (!window.customElements) { document.write('<!--'); }</script>
    <script type="text/javascript" src="../../webcomponentsjs/custom-elements-es5-adapter.js"></script>
    <!--! do not remove -->
<script src="../../webcomponentsjs/webcomponents-lite.js"></script><script src="../../web-component-tester/browser.js"></script><script src="../../iron-test-helpers/mock-interactions.js"></script><link rel="import" href="../../polymer/polymer.html"><link rel="import" href="../iron-a11y-keys-behavior.html"></head><body><test-fixture id="BasicKeys"><template><x-a11y-basic-keys></x-a11y-basic-keys></template></test-fixture><test-fixture id="NonPropagatingKeys"><template><x-a11y-basic-keys stop-keyboard-event-propagation=""></x-a11y-basic-keys></template></test-fixture><test-fixture id="ComboKeys"><template><x-a11y-combo-keys></x-a11y-combo-keys></template></test-fixture><test-fixture id="AlternativeEventKeys"><template><x-a11y-alternate-event-keys></x-a11y-alternate-event-keys></template></test-fixture><test-fixture id="BehaviorKeys"><template><x-a11y-behavior-keys></x-a11y-behavior-keys></template></test-fixture><test-fixture id="PreventKeys"><template><x-a11y-prevent-keys></x-a11y-prevent-keys></template></test-fixture><script>suite('Polymer.IronA11yKeysBehavior',function(){var a;suiteSetup(function(){var b=[Polymer.IronA11yKeysBehavior,{properties:{keyCount:{type:Number,value:0}},_keyHandler:function(e){this.keyCount++,this.lastEvent=e},_keyHandler2:function(e){this.keyCount++,this.lastEvent=e},_preventDefaultHandler:function(e){e.preventDefault(),this.keyCount++,this.lastEvent=e}}];Polymer({is:'x-a11y-basic-keys',behaviors:[b],keyBindings:{space:'_keyHandler',"@":'_keyHandler',esc:'_keyHandler'}}),Polymer({is:'x-a11y-combo-keys',behaviors:[b],keyBindings:{enter:'_keyHandler2',"ctrl+shift+a shift+enter":'_keyHandler'}}),Polymer({is:'x-a11y-alternate-event-keys',behaviors:[b],keyBindings:{"space:keyup":'_keyHandler'}});var c={keyBindings:{enter:'_keyHandler'}};Polymer({is:'x-a11y-behavior-keys',behaviors:[b,c],keyBindings:{enter:'_keyHandler'}}),Polymer({is:'x-a11y-prevent-keys',behaviors:[b,c],keyBindings:{"space a":'_keyHandler',"enter shift+a":'_preventDefaultHandler'}})}),suite('basic keys',function(){setup(function(){a=fixture('BasicKeys')}),test('trigger the handler when the specified key is pressed',function(){MockInteractions.pressSpace(a),expect(a.keyCount).to.be.equal(1)}),test('keyEventTarget can be null, and disables listeners',function(){a.keyEventTarget=null,MockInteractions.pressSpace(a),expect(a.keyCount).to.be.equal(0)}),test('trigger the handler when the specified key is pressed together with a modifier',function(){var b=new CustomEvent('keydown');b.ctrlKey=!0,b.keyCode=b.code=32,a.dispatchEvent(b),expect(a.keyCount).to.be.equal(1)}),test('handles special character @',function(){MockInteractions.pressAndReleaseKeyOn(a,void 0,[],'@'),expect(a.keyCount).to.be.equal(1)}),test('handles variations of Esc key',function(){MockInteractions.pressAndReleaseKeyOn(a,void 0,[],'Esc'),expect(a.keyCount).to.be.equal(1),MockInteractions.pressAndReleaseKeyOn(a,void 0,[],'Escape'),expect(a.keyCount).to.be.equal(2),MockInteractions.pressAndReleaseKeyOn(a,27,[],''),expect(a.keyCount).to.be.equal(3)}),test('do not trigger the handler for non-specified keys',function(){MockInteractions.pressEnter(a),expect(a.keyCount).to.be.equal(0)}),test('can have bindings added imperatively',function(){a.addOwnKeyBinding('enter','_keyHandler'),MockInteractions.pressEnter(a),expect(a.keyCount).to.be.equal(1),MockInteractions.pressSpace(a),expect(a.keyCount).to.be.equal(2)}),test('can remove imperatively added bindings',function(){a.addOwnKeyBinding('enter','_keyHandler'),a.removeOwnKeyBindings(),MockInteractions.pressEnter(a),expect(a.keyCount).to.be.equal(0),MockInteractions.pressSpace(a),expect(a.keyCount).to.be.equal(1)}),test('allows propagation beyond the key combo handler',function(){var b=sinon.spy();document.addEventListener('keydown',b),MockInteractions.pressEnter(a),expect(b.callCount).to.be.equal(1)}),suite('edge cases',function(){test('knows that `spacebar` is the same as `space`',function(){var b=new CustomEvent('keydown');b.key='spacebar',expect(a.keyboardEventMatchesKeys(b,'space')).to.be.equal(!0)}),test('handles `+`',function(){var b=new CustomEvent('keydown');b.key='+',expect(a.keyboardEventMatchesKeys(b,'+')).to.be.equal(!0)}),test('handles `:`',function(){var b=new CustomEvent('keydown');b.key=':',expect(a.keyboardEventMatchesKeys(b,':')).to.be.equal(!0)}),test('handles ` ` (space)',function(){var b=new CustomEvent('keydown');b.key=' ',expect(a.keyboardEventMatchesKeys(b,'space')).to.be.equal(!0)})}),suite('matching keyboard events to keys',function(){test('can be done imperatively',function(){var b=new CustomEvent('keydown');b.keyCode=65,expect(a.keyboardEventMatchesKeys(b,'a')).to.be.equal(!0)}),test('can be done with a provided keyboardEvent',function(){var b;MockInteractions.pressSpace(a),b=a.lastEvent,expect(b.detail.keyboardEvent).to.be.okay,expect(a.keyboardEventMatchesKeys(b,'space')).to.be.equal(!0)}),test('can handle variations in arrow key names',function(){var b=new CustomEvent('keydown');b.key='up',expect(a.keyboardEventMatchesKeys(b,'up')).to.be.equal(!0),b.key='ArrowUp',expect(a.keyboardEventMatchesKeys(b,'up')).to.be.equal(!0)}),test('can handle function keys',function(){var b=new CustomEvent('keydown');b.keyCode=112,expect(a.keyboardEventMatchesKeys(b,'f1')).to.be.equal(!0),b.keyCode=123,expect(a.keyboardEventMatchesKeys(b,'f12')).to.be.equal(!0)})}),suite('matching keyboard events to top row and number pad digit keys',function(){test('top row can be done imperatively',function(){var b=new CustomEvent('keydown');b.keyCode=49,expect(a.keyboardEventMatchesKeys(b,'1')).to.be.equal(!0)}),test('number pad digits can be done imperatively',function(){var b=new CustomEvent('keydown');b.keyCode=97,expect(a.keyboardEventMatchesKeys(b,'1')).to.be.equal(!0)})})}),suite('combo keys',function(){setup(function(){a=fixture('ComboKeys')}),test('trigger the handler when the combo is pressed',function(){var b=new CustomEvent('keydown');b.ctrlKey=!0,b.shiftKey=!0,b.keyCode=b.code=65,a.dispatchEvent(b),expect(a.keyCount).to.be.equal(1)}),test('check if KeyBoardEvent.key is alpha-numberic',function(){var b=new CustomEvent('keydown');b.ctrlKey=!0,b.shiftKey=!0,b.key='A',a.dispatchEvent(b),expect(a.keyCount).to.be.equal(1)}),test('trigger also bindings without modifiers',function(){var b=new CustomEvent('keydown');b.shiftKey=!0,b.keyCode=b.code=13,a.dispatchEvent(b),expect(a.keyCount).to.be.equal(2)}),test('give precendence to combos with modifiers',function(){var b=sinon.spy(a,'_keyHandler2'),c=sinon.spy(a,'_keyHandler'),d=new CustomEvent('keydown');d.shiftKey=!0,d.keyCode=d.code=13,a.dispatchEvent(d),expect(b.called).to.be.true,expect(c.called).to.be.true,expect(b.calledAfter(c)).to.be.true})}),suite('alternative event keys',function(){setup(function(){a=fixture('AlternativeEventKeys')}),test('trigger on the specified alternative keyboard event',function(){MockInteractions.keyDownOn(a,32),expect(a.keyCount).to.be.equal(0),MockInteractions.keyUpOn(a,32),expect(a.keyCount).to.be.equal(1)})}),suite('behavior keys',function(){setup(function(){a=fixture('BehaviorKeys')}),test('bindings in other behaviors are transitive',function(){MockInteractions.pressEnter(a),expect(a.keyCount).to.be.equal(2)})}),suite('stopping propagation automatically',function(){setup(function(){a=fixture('NonPropagatingKeys')}),test('does not propagate key events beyond the combo handler',function(){var b=sinon.spy();document.addEventListener('keydown',b),MockInteractions.pressEnter(a),expect(b.callCount).to.be.equal(0)})}),suite('prevent default behavior of event',function(){setup(function(){a=fixture('PreventKeys')}),test('`defaultPrevented` is correctly set',function(){MockInteractions.pressEnter(a),expect(a.lastEvent.defaultPrevented).to.be.equal(!0)}),test('only 1 handler is invoked',function(){var b=sinon.spy(a,'_keyHandler'),c=sinon.spy(a,'_preventDefaultHandler'),d=new CustomEvent('keydown',{cancelable:!0});d.shiftKey=!0,d.keyCode=d.code=65,a.dispatchEvent(d),expect(a.keyCount).to.be.equal(1),expect(c.called).to.be.true,expect(b.called).to.be.false})}),suite('remove key behavior with null target',function(){test('add and remove a iron-a11y-keys-behavior',function(){var b=document.createElement('x-a11y-basic-keys');b.keyEventTarget=null,document.body.appendChild(b),document.body.removeChild(b)})})});</script></body></html>