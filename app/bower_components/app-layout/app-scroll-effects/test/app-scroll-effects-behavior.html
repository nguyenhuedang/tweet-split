<!DOCTYPE html><html><head><meta charset="UTF-8"><title>test for app-scroll-effects-behavior</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
    <script>if (!window.customElements) { document.write('<!--'); }</script>
    <script type="text/javascript" src="../../../webcomponentsjs/custom-elements-es5-adapter.js"></script>
    <!--! do not remove -->
<script src="../../../webcomponentsjs/webcomponents-lite.js"></script><script src="../../../web-component-tester/browser.js"></script><script src="../../../test-fixture/test-fixture-mocha.js"></script><link rel="import" href="../../../test-fixture/test-fixture.html"><link rel="import" href="x-container.html"><style>body{margin:0;padding:0;height:1000vh;}x-container{position:fixed;top:0;left:0;right:0;height:200px;}</style></head><body><test-fixture id="testHeader"><template><x-container></x-container></template></test-fixture><script>function scrollTestHelper(a,b){function c(){var f=b.shift();f&&(f.callback(),0<b.length&&d())}function d(){var f=a===document.documentElement?window.pageYOffset:a.scrollTop;b[0].y===f?c():a===document.documentElement?window.scrollTo(0,b[0].y):a.scrollTop=b[0].y}if(0<b.length){var e=a===document.documentElement?window:a;e.addEventListener('scroll',c),d()}}suite('basic features',function(){var a,b;suiteSetup(function(){b={setUp:sinon.spy(),tearDown:sinon.spy(),run:sinon.spy()},Polymer.AppLayout.registerEffect('test-effect',b)}),setup(function(){a=fixture('testHeader'),b.setUp.reset(),b.tearDown.reset(),b.run.reset()}),test('simple effect',function(c){a.effects='test-effect',flush(function(){scrollTestHelper(a.scrollTarget,[{y:0,callback:function(){assert.isTrue(b.setUp.called),assert.deepEqual(b.run.lastCall.args,[0,0])}},{y:0.5*a.offsetHeight,callback:function(){assert.deepEqual(b.run.lastCall.args,[0.5,0.5*a.offsetHeight])}},{y:a.offsetHeight,callback:function(){assert.deepEqual(b.run.lastCall.args,[1,a.offsetHeight])}},{y:2*a.offsetHeight,callback:function(){assert.deepEqual(b.run.lastCall.args,[2,2*a.offsetHeight])}},{y:3*a.offsetHeight,callback:function(){assert.deepEqual(b.run.lastCall.args,[3,3*a.offsetHeight]),a.effects='',assert.isTrue(b.tearDown.called),c()}}])})}),test('effect with config',function(c){var d={startsAt:0.5,endsAt:1};a.effects='test-effect',a.effectsConfig={"test-effect":d},flush(function(){scrollTestHelper(a.scrollTarget,[{y:0,callback:function(){assert.isTrue(b.setUp.called),assert.deepEqual(b.setUp.lastCall.args,[d]),assert.deepEqual(b.run.lastCall.args,[0,0])}},{y:0.25*a.offsetHeight,callback:function(){assert.deepEqual(b.run.lastCall.args,[0,0.25*a.offsetHeight])}},{y:0.5*a.offsetHeight,callback:function(){assert.deepEqual(b.run.lastCall.args,[0,0.5*a.offsetHeight])}},{y:0.75*a.offsetHeight,callback:function(){assert.deepEqual(b.run.lastCall.args,[0.5,0.75*a.offsetHeight])}},{y:a.offsetHeight,callback:function(){assert.deepEqual(b.run.lastCall.args,[1,a.offsetHeight]),a.effects='',assert.isTrue(b.tearDown.called),c()}}])})}),test('threshold and threshold-triggered',function(c){flush(function(){assert.isUndefined(a.thresholdTriggered),assert.equal(a.threshold,0),a.threshold=100,scrollTestHelper(a.scrollTarget,[{y:0,callback:function(){assert.isFalse(a.thresholdTriggered)}},{y:100,callback:function(){assert.isTrue(a.thresholdTriggered)}},{y:50,callback:function(){assert.isFalse(a.thresholdTriggered),c()}}])})})});</script></body></html>