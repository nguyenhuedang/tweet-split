<!DOCTYPE html><html><head><meta charset="UTF-8"><title>marked-element basic tests</title><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
    <script>if (!window.customElements) { document.write('<!--'); }</script>
    <script type="text/javascript" src="../../webcomponentsjs/custom-elements-es5-adapter.js"></script>
    <!--! do not remove -->
<script src="../../webcomponentsjs/webcomponents-lite.js"></script><script src="../../web-component-tester/browser.js"></script><script src="../../test-fixture/test-fixture-mocha.js"></script><link rel="import" href="../../test-fixture/test-fixture.html"><link rel="import" href="../../polymer/polymer.html"><link rel="import" href="../marked-element.html"></head><body><test-fixture id="NoContent"><template><marked-element><div id="output" slot="markdown-html"></div><script type="text/markdown"></script></marked-element></template></test-fixture><test-fixture id="SmartyPants"><template><marked-element smartypants=""><div id="output" slot="markdown-html"></div><script type="text/markdown"># foo
        ...</script></marked-element></template></test-fixture><test-fixture id="CamelCaseHTML"><template><marked-element><div id="output" slot="markdown-html"></div><script type="text/markdown">```html
<div camelCase></div>
```</script></marked-element></template></test-fixture><test-fixture id="BadHTML"><template><marked-element><div id="output" slot="markdown-html"></div><script type="text/markdown">```html
<p><div></p></div>
```</script></marked-element></template></test-fixture><test-fixture id="CamelCaseHTMLWithoutChild"><template><marked-element><script type="text/markdown">```html
<div camelCase></div>
```</script></marked-element></template></test-fixture><test-fixture id="BadHTMLWithoutChild"><template><marked-element><script type="text/markdown">```html
<p><div></p></div>
```</script></marked-element></template></test-fixture><test-fixture id="Renderer"><template><marked-element><div id="output" slot="markdown-html"></div><script type="text/markdown">[Link](http://url.com)</script></marked-element></template></test-fixture><test-fixture id="CustomCallbackFunction"><template><marked-element><div id="output" slot="markdown-html"></div><script type="text/markdown">Some content</script></marked-element></template></test-fixture><test-fixture id="RemoteContent"><template><marked-element><div id="output" slot="markdown-html"></div><script type="text/markdown" src="test.md"># Loading

          Please wait...</script></marked-element></template></test-fixture><test-fixture id="BadRemoteContent"><template><marked-element><div id="output" slot="markdown-html"></div><script type="text/markdown" src="test3.md"></script></marked-element></template></test-fixture><test-fixture id="ChangingRemoteContent"><template><dom-bind><template is="dom-bind"><marked-element id="markedElement"><div id="output" slot="markdown-html"></div><script type="text/markdown" src$="[[source]]"># Loading

              Please wait...</script></marked-element></template></dom-bind></template></test-fixture><test-fixture id="SanitizedRemoteContent"><template><marked-element><div id="output" slot="markdown-html"></div><script type="text/markdown" src="remoteSanitization.md"></script></marked-element></template></test-fixture><test-fixture id="UnsanitizedRemoteContent"><template><marked-element disable-remote-sanitization=""><div id="output" slot="markdown-html"></div><script type="text/markdown" src="remoteSanitization.md"></script></marked-element></template></test-fixture><script>'use strict';function isHidden(a){var b=a.getBoundingClientRect();return 0==b.width&&0==b.height}function escapeHTML(a){var b=document.createElement('span');return b.textContent=a,b.innerHTML}suite('<marked-element> has some options of marked available',function(){var a,b;setup(function(){a=fixture('SmartyPants'),b=document.getElementById('output')}),test('has sanitize',function(){expect(a.sanitize).to.equal(!1)}),test('has pedantic',function(){expect(a.pedantic).to.equal(!1)}),test('has breaks',function(){expect(a.breaks).to.equal(!1)}),test('has smartypants',function(){expect(a.smartypants).to.equal(!0)})}),suite('<marked-element> has some options of marked available',function(){var a,b,c;setup(function(){a=fixture('CustomCallbackFunction'),b=document.createElement('div'),c=document.getElementById('output')}),test('calls callback after render',function(){b.innerHTML='<div>Overridden!</div>',a.callback=function(d,f){return assert.equal(f,'<p>Some content</p>\n'),'<div>Overridden!</div>'},expect(c.innerHTML).to.equal(b.innerHTML)})}),suite('<marked-element> with .markdown-html child',function(){suite('ignores no content',function(){var a,b,c;setup(function(){a=fixture('NoContent'),b=document.createElement('div'),c=document.getElementById('output')}),test('in code blocks',function(){b.innerHTML='',expect(c).to.equal(a.outputElement),expect(isHidden(a.$.content)).to.be.true,expect(a.markdown).to.equal(null),expect(c.innerHTML).to.equal(b.innerHTML)})}),suite('respects camelCased HTML',function(){var a,b,c;setup(function(){a=fixture('CamelCaseHTML'),b=document.createElement('div'),c=document.getElementById('output')}),test('in code blocks',function(){b.innerHTML='<div camelCase></div>',expect(c).to.equal(a.outputElement),expect(isHidden(a.$.content)).to.be.true,expect(b.innerHTML).to.eql('<div camelcase=""></div>'),expect(c.innerHTML).to.include(escapeHTML('<div camelCase>'))})}),suite('respects bad HTML',function(){var a,b,c;setup(function(){a=fixture('BadHTML'),b=document.createElement('div'),c=document.getElementById('output')}),test('in code blocks',function(){b.innerHTML='<p><div></p></div>',expect(c).to.equal(a.outputElement),expect(isHidden(a.$.content)).to.be.true;var d='<p><div><p></p></div>'===b.innerHTML||'<p></p><div><p></p></div>'===b.innerHTML;expect(d).be.true,expect(c.innerHTML).to.include(escapeHTML('<p><div></p></div>'))})})}),suite('<marked-element> without .markdown-html child',function(){suite('respects camelCased HTML',function(){var a,b;setup(function(){a=fixture('CamelCaseHTMLWithoutChild'),b=document.createElement('div')}),test('in code blocks',function(){Polymer.dom(b).innerHTML='<div camelCase></div>',expect(a.$.content).to.equal(a.outputElement),Polymer.dom.flush(),expect(isHidden(a.$.content)).to.be.false,expect(b.innerHTML).to.eql('<div camelcase=""></div>'),expect(a.$.content.innerHTML).to.include(escapeHTML('<div camelCase>'))})}),suite('respects bad HTML',function(){var a,b;setup(function(){a=fixture('BadHTMLWithoutChild'),b=document.createElement('div')}),test('in code blocks',function(){b.innerHTML='<p><div></p></div>',expect(a.$.content).to.equal(a.outputElement),Polymer.dom.flush(),expect(isHidden(a.$.content)).to.be.false;var c='<p><div><p></p></div>'===b.innerHTML||'<p></p><div><p></p></div>'===b.innerHTML;expect(c).be.true,expect(a.$.content.innerHTML).to.include(escapeHTML('<p><div></p></div>'))})})}),suite('<marked-element> with custom renderer',function(){var a,b,c;setup(function(){a=fixture('Renderer'),b=document.getElementById('output'),c=document.createElement('div')}),test('takes custom link renderer',function(){a.renderer=function(d){d.link=function(f,g,h){return'<a href="'+f+'" target="_blank">'+h+'</a>'}},c.innerHTML='<a href="http://url.com" target="_blank">Link</a>',expect(b.innerHTML).to.include(c.innerHTML)})}),suite('<marked-element> with remote content',function(){var a,b,c,d;suite('succesful fetch',function(){setup(function(){a=fixture('RemoteContent'),c=document.getElementById('output'),d=document.createElement('div')}),test('renders remote content',function(f){d.innerHTML='<h1 id="test">Test</h1>\n<p><a href="http://url.com/">Link</a></p>\n',a.addEventListener('marked-loadend',function(){expect(c.innerHTML).to.equal(d.innerHTML),f()})}),test('renders content while remote content is loading',function(){d.innerHTML='<h1 id="loading">Loading</h1>\n<p>Please wait...</p>\n',expect(c.innerHTML).to.equal(d.innerHTML)}),test('renders new remote content when src changes',function(f){a.addEventListener('marked-loadend',function g(){a.removeEventListener('marked-loadend',g),d.innerHTML='<h1 id="test-2">Test 2</h1>\n',Polymer.dom(a).querySelector('[type="text/markdown"]').src='test2.md',a.addEventListener('marked-loadend',function(){expect(c.innerHTML).to.equal(d.innerHTML),f()})})})}),suite('fails to load',function(){setup(function(){a=fixture('BadRemoteContent'),c=document.getElementById('output'),d=document.createElement('div')}),test('renders error message',function(f){d.innerHTML='<p>Failed loading markdown source</p>\n',a.addEventListener('marked-loadend',function(){expect(c.innerHTML).to.equal(d.innerHTML),f()})}),test('doesn\'t render error message when default is prevented',function(f){d.innerHTML='',a.addEventListener('marked-request-error',function(g){g.preventDefault(),flush(function(){expect(c.innerHTML).to.equal(d.innerHTML),f()})})})}),suite('changing remote content with data binding',function(){setup(function(){b=fixture('ChangingRemoteContent'),Polymer.Element||(b=b.children[0]),a=b.$.markedElement,c=b.$.output,d=document.createElement('div')}),test('renders remote content',function(f){d.innerHTML='<h1 id="test">Test</h1>\n<p><a href="http://url.com/">Link</a></p>\n',b.source='test.md',a.addEventListener('marked-loadend',function g(){expect(c.innerHTML).to.equal(d.innerHTML),a.removeEventListener('marked-loadend',g),d.innerHTML='<h1 id="test-another">Test Another</h1>\n<p><a href="http://url.com/">Link</a></p>\n',b.source='test1.md',a.addEventListener('marked-loadend',function(){expect(c.innerHTML).to.equal(d.innerHTML),f()})}.bind(this))}),test('renders content while remote content is loading',function(f){d.innerHTML='<h1 id="loading">Loading</h1>\n<p>Please wait...</p>\n',c.innerHTML&&(expect(c.innerHTML).to.equal(d.innerHTML),f()),a.addEventListener('marked-render-complete',function(){expect(c.innerHTML).to.equal(d.innerHTML),f()})})}),suite('sanitizing remote content',function(){suite('sanitized',function(){setup(function(){a=fixture('SanitizedRemoteContent')}),test('sanitizes remote content',function(f){c=a.querySelector('#output'),d=document.createElement('div'),d.innerHTML='<p>&lt;div&gt;&lt;/div&gt;</p>\n',a.addEventListener('marked-loadend',function(){assert.isTrue(a.sanitize),assert.isNotTrue(a.disableRemoteSanitization),expect(c.innerHTML).to.equal(d.innerHTML),f()})})}),suite('unsanitized',function(){setup(function(){a=fixture('UnsanitizedRemoteContent')}),test('does not sanitize remote content',function(f){c=a.querySelector('#output'),d=document.createElement('div');document.createElement('div');d.innerHTML='<div></div>',a.addEventListener('marked-loadend',function(){assert.isNotTrue(a.sanitize),assert.isTrue(a.disableRemoteSanitization),expect(c.innerHTML).to.equal(d.innerHTML),f()})})})})}),suite('events',function(){var a,b;setup(function(){a=fixture('CamelCaseHTML'),b=document.getElementById('output')}),test('render() fires marked-render-complete',function(c){a.addEventListener('marked-render-complete',function(){expect(b.innerHTML).to.not.equal(''),c()}),a.render()})});</script></body></html>