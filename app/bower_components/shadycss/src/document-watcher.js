'use strict';import{nativeShadow}from'./style-settings.js';import StyleTransformer from'./style-transformer.js';import{getIsExtends}from'./style-util.js';export var flush=function(){};function getClasses(a){var b=[];return a.classList?b=Array.from(a.classList):a instanceof window.SVGElement&&a.hasAttribute('class')&&(b=a.getAttribute('class').split(/\s+/)),b}function getCurrentScope(a){var b=getClasses(a),c=b.indexOf(StyleTransformer.SCOPE_NAME);return-1<c?b[c+1]:''}function handler(a){for(var c,b=0;b<a.length;b++)if(c=a[b],c.target!==document.documentElement&&c.target!==document.head)for(var e,d=0;d<c.addedNodes.length;d++)if(e=c.addedNodes[d],e.nodeType===Node.ELEMENT_NODE){e=e;var f=e.getRootNode(),g=getCurrentScope(e);if(g&&f===e.ownerDocument)StyleTransformer.dom(e,g,!0);else if(f.nodeType===Node.DOCUMENT_FRAGMENT_NODE){var h=void 0,j=f.host;if(!j)continue;if(h=getIsExtends(j).is,g===h)continue;g&&StyleTransformer.dom(e,g,!0),StyleTransformer.dom(e,h)}}}if(!nativeShadow){var observer=new MutationObserver(handler),start=function(b){observer.observe(b,{childList:!0,subtree:!0})},nativeCustomElements=window.customElements&&!window.customElements.polyfillWrapFlushCallback;if(nativeCustomElements)start(document);else{var delayedStart=function(){start(document.body)};window.HTMLImports?window.HTMLImports.whenReady(delayedStart):requestAnimationFrame(function(){if('loading'===document.readyState){var a=function b(){delayedStart(),document.removeEventListener('readystatechange',b)};document.addEventListener('readystatechange',a)}else delayedStart()})}flush=function(){handler(observer.takeRecords())}}