<!DOCTYPE html><html><head><title>iron-fit-behavior tests</title><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,user-scalable=yes">
    <script>if (!window.customElements) { document.write('<!--'); }</script>
    <script type="text/javascript" src="../../webcomponentsjs/custom-elements-es5-adapter.js"></script>
    <!--! do not remove -->
<script src="../../webcomponentsjs/webcomponents-lite.js"></script><script src="../../web-component-tester/browser.js"></script><link rel="import" href="test-fit.html"><style>body{margin:0;padding:0;}.absolute{position:absolute;top:0;left:0;}.scrolling{overflow:auto;}.sized-x{width:100px;}.sized-y{height:100px;}.positioned-left{position:absolute;left:100px;}.positioned-right{position:absolute;right:100px;}.positioned-top{position:absolute;top:100px;}.positioned-bottom{position:absolute;bottom:100px;}.with-max-width{max-width:500px;}.with-max-height{max-height:500px;}.with-margin{margin:20px;}.constrain{position:fixed;top:20px;left:20px;width:150px;height:150px;border:1px solid black;box-sizing:border-box;}.sizer{width:9999px;height:9999px;}</style></head><body><div class="constrain"></div><test-fixture id="basic"><template><test-fit>Basic</test-fit></template></test-fixture><test-fixture id="absolute"><template><test-fit auto-fit-on-attach="" class="absolute">Absolutely positioned</test-fit></template></test-fixture><test-fixture id="sized-xy"><template><test-fit auto-fit-on-attach="" class="sized-x sized-y">Sized (x/y), auto center/center</test-fit></template></test-fixture><test-fixture id="sized-x"><template><test-fit auto-fit-on-attach="" class="sized-x">Sized (x), auto center/center</test-fit></template></test-fixture><test-fixture id="positioned-xy"><template><test-fit auto-fit-on-attach="" class="sized-x positioned-left positioned-top">Sized (x/y), positioned/positioned</test-fit></template></test-fixture><test-fixture id="inline-positioned-xy"><template><test-fit auto-fit-on-attach="" class="sized-x sized-y" style="position:absolute;left:100px;top:100px">Sized (x/y), positioned/positioned</test-fit></template></test-fixture><test-fixture id="sectioned"><template><test-fit auto-fit-on-attach="" class="sized-x"><div>Sized (x), auto center/center with scrolling section</div><div class="internal"></div></test-fit></template></test-fixture><test-fixture id="constrain-target"><template><div class="constrain"><test-fit auto-fit-on-attach="" class="el sized-x sized-y"><div>Auto center/center to parent element</div></test-fit></div></template></test-fixture><test-fixture id="offscreen-container"><template><div style="position: fixed; top: -1px; left: 0"><test-fit auto-fit-on-attach="" class="el sized-x"><div>Sized (x), auto center/center, container is offscreen</div></test-fit></div></template></test-fixture><test-fixture id="scrollable"><template><test-fit auto-fit-on-attach="" class="scrolling">scrollable<div class="sizer"></div></test-fit></template></test-fixture><template id="ipsum"><p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p></template><script>function makeScrolling(a){a.classList.add('scrolling');for(var b=document.getElementById('ipsum'),c=0;20>c;c++)a.appendChild(b.content.cloneNode(!0))}function intersects(a,b){return!(b.left>=a.right||b.right<=a.left||b.top>=a.bottom||b.bottom<=a.top)}suite('basic',function(){var a;setup(function(){a=fixture('basic')}),test('position() works without autoFitOnAttach',function(){a.verticalAlign='top',a.horizontalAlign='left',a.position();var b=a.getBoundingClientRect();assert.equal(b.top,0,'top ok'),assert.equal(b.left,0,'left ok')}),test('constrain() works without autoFitOnAttach',function(){a.constrain();var b=getComputedStyle(a);assert.equal(b.maxWidth,window.innerWidth+'px','maxWidth ok'),assert.equal(b.maxHeight,window.innerHeight+'px','maxHeight ok')}),test('center() works without autoFitOnAttach',function(){a.center();var b=a.getBoundingClientRect();assert.closeTo(b.left-(window.innerWidth-b.right),0,5,'centered horizontally'),assert.closeTo(b.top-(window.innerHeight-b.bottom),0,5,'centered vertically')})}),suite('manual positioning',function(){test('css positioned element is not re-positioned',function(){var a=fixture('positioned-xy'),b=a.getBoundingClientRect();assert.equal(b.top,100,'top is unset'),assert.equal(b.left,100,'left is unset')}),test('inline positioned element is not re-positioned',function(){var a=fixture('inline-positioned-xy'),b=a.getBoundingClientRect(),c=document.body.getBoundingClientRect();assert.equal(b.top,100,'top is unset'),assert.equal(b.left,100,'left is unset'),a.refit(),b=a.getBoundingClientRect(),assert.equal(b.top,100,'top is unset after refit'),assert.equal(b.left,100,'left is unset after refit')}),test('position property is preserved after',function(){var a=fixture('absolute');assert.equal(getComputedStyle(a).position,'absolute','position:absolute is preserved')})}),suite('fit to window',function(){test('sized element is centered in viewport',function(){var a=fixture('sized-xy'),b=a.getBoundingClientRect();assert.closeTo(b.left-(window.innerWidth-b.right),0,5,'centered horizontally'),assert.closeTo(b.top-(window.innerHeight-b.bottom),0,5,'centered vertically')}),test('sized element with margin is centered in viewport',function(){var a=fixture('sized-xy');a.classList.add('with-margin'),a.refit();var b=a.getBoundingClientRect();assert.closeTo(b.left-(window.innerWidth-b.right),0,5,'centered horizontally'),assert.closeTo(b.top-(window.innerHeight-b.bottom),0,5,'centered vertically')}),test('sized element with transformed parent is centered in viewport',function(){var a=fixture('constrain-target'),b=Polymer.dom(a).querySelector('.el'),c=b.getBoundingClientRect();a.style.transform='translate3d(5px, 5px, 0)',b.center();var d=b.getBoundingClientRect();assert.equal(c.top,d.top,'top ok'),assert.equal(c.bottom,d.bottom,'bottom ok'),assert.equal(c.left,d.left,'left ok'),assert.equal(c.right,d.right,'right ok')}),test('scrolling element is centered in viewport',function(){var a=fixture('sized-x');makeScrolling(a),a.refit();var b=a.getBoundingClientRect();assert.closeTo(b.left-(window.innerWidth-b.right),0,5,'centered horizontally'),assert.closeTo(b.top-(window.innerHeight-b.bottom),0,5,'centered vertically')}),test('scrolling element is constrained to viewport height',function(){var a=fixture('sized-x');makeScrolling(a),a.refit();var b=a.getBoundingClientRect();assert.isTrue(b.height<=window.innerHeight,'height is less than or equal to viewport height')}),test('scrolling element with offscreen container is constrained to viewport height',function(){var a=fixture('offscreen-container'),b=Polymer.dom(a).querySelector('.el');makeScrolling(b),b.refit();var c=b.getBoundingClientRect();assert.isTrue(c.height<=window.innerHeight,'height is less than or equal to viewport height')}),test('scrolling element with max-height is centered in viewport',function(){var a=fixture('sized-x');a.classList.add('with-max-height'),makeScrolling(a),a.refit();var b=a.getBoundingClientRect();assert.closeTo(b.left-(window.innerWidth-b.right),0,5,'centered horizontally'),assert.closeTo(b.top-(window.innerHeight-b.bottom),0,5,'centered vertically')}),test('scrolling element with max-height respects max-height',function(){var a=fixture('sized-x');a.classList.add('with-max-height'),makeScrolling(a),a.refit();var b=a.getBoundingClientRect();assert.isTrue(500>=b.height,'height is less than or equal to max-height')}),test('css positioned, scrolling element is constrained to viewport height (top,left)',function(){var a=fixture('positioned-xy');makeScrolling(a),a.refit();var b=a.getBoundingClientRect();assert.isTrue(b.height<=window.innerHeight-100,'height is less than or equal to viewport height')}),test('css positioned, scrolling element is constrained to viewport height (bottom, right)',function(){var a=fixture('sized-x');a.classList.add('positioned-bottom'),a.classList.add('positioned-right'),a.refit();var b=a.getBoundingClientRect();assert.isTrue(b.height<=window.innerHeight-100,'height is less than or equal to viewport height')}),test('sized, scrolling element with margin is centered in viewport',function(){var a=fixture('sized-x');a.classList.add('with-margin'),makeScrolling(a),a.refit();var b=a.getBoundingClientRect();assert.closeTo(b.left-(window.innerWidth-b.right),0,5,'centered horizontally'),assert.closeTo(b.top-(window.innerHeight-b.bottom),0,5,'centered vertically')}),test('sized, scrolling element is constrained to viewport height',function(){var a=fixture('sized-x');a.classList.add('with-margin'),makeScrolling(a),a.refit();var b=a.getBoundingClientRect();assert.isTrue(b.height<=window.innerHeight-40,'height is less than or equal to viewport height')}),test('css positioned, scrolling element with margin is constrained to viewport height (top, left)',function(){var a=fixture('positioned-xy');a.classList.add('with-margin'),makeScrolling(a),a.refit();var b=a.getBoundingClientRect();assert.isTrue(b.height<=window.innerHeight-100-40,'height is less than or equal to viewport height')}),test('css positioned, scrolling element with margin is constrained to viewport height (bottom, right)',function(){var a=fixture('sized-x');a.classList.add('positioned-bottom'),a.classList.add('positioned-right'),a.classList.add('with-margin'),a.refit();var b=a.getBoundingClientRect();assert.isTrue(b.height<=window.innerHeight-100-40,'height is less than or equal to viewport height')}),test('scrolling sizingTarget is constrained to viewport height',function(){el=fixture('sectioned');var a=Polymer.dom(el).querySelector('.internal');el.sizingTarget=a,makeScrolling(a),el.refit();var b=el.getBoundingClientRect();assert.isTrue(b.height<=window.innerHeight,'height is less than or equal to viewport height')}),test('scrolling sizingTarget preserves scrolling position',function(){el=fixture('scrollable'),el.scrollTop=20,el.scrollLeft=20,el.refit(),assert.equal(el.scrollTop,20,'scrollTop ok'),assert.equal(el.scrollLeft,20,'scrollLeft ok')})}),suite('fit to element',function(){test('element fits in another element',function(){var a=fixture('constrain-target'),b=Polymer.dom(a).querySelector('.el');makeScrolling(b),b.fitInto=a,b.refit();var c=b.getBoundingClientRect(),d=a.getBoundingClientRect();assert.isTrue(c.height<=d.height,'width is less than or equal to fitInto width'),assert.isTrue(c.height<=d.height,'height is less than or equal to fitInto height')}),test('element centers in another element',function(){var a=fixture('constrain-target'),b=Polymer.dom(a).querySelector('.el');makeScrolling(b),b.fitInto=a,b.refit();var c=b.getBoundingClientRect(),d=a.getBoundingClientRect();assert.closeTo(c.left-d.left-(d.right-c.right),0,5,'centered horizontally in fitInto'),assert.closeTo(c.top-d.top-(d.bottom-c.bottom),0,5,'centered vertically in fitInto')}),test('element with max-width centers in another element',function(){var a=document.querySelector('.constrain'),b=fixture('sized-xy');b.classList.add('with-max-width'),b.fitInto=a,b.refit();var c=b.getBoundingClientRect(),d=a.getBoundingClientRect();assert.closeTo(c.left-d.left-(d.right-c.right),0,5,'centered horizontally in fitInto'),assert.closeTo(c.top-d.top-(d.bottom-c.bottom),0,5,'centered vertically in fitInto')}),test('positioned element fits in another element',function(){var a=document.querySelector('.constrain'),b=fixture('sized-xy');b.verticalAlign='top',b.horizontalAlign='left',b.fitInto=a,b.refit();var c=b.getBoundingClientRect(),d=a.getBoundingClientRect();assert.equal(c.top,d.top,'top ok'),assert.equal(c.left,d.left,'left ok')})}),suite('horizontal/vertical align',function(){var a,b,c,d,e={left:0,top:0,right:window.innerWidth,bottom:window.innerHeight,width:window.innerWidth,height:window.innerHeight};setup(function(){a=fixture('constrain-target'),b=a.getBoundingClientRect(),c=Polymer.dom(a).querySelector('.el'),d=c.getBoundingClientRect()}),test('intersects works',function(){var f={top:0,bottom:1,left:0,right:1};assert.isTrue(intersects(f,f),'intersects itself'),assert.isFalse(intersects(f,{top:1,bottom:2,left:0,right:1}),'no intersect on edge'),assert.isFalse(intersects(f,{top:-2,bottom:-1,left:0,right:1}),'no intersect on edge (negative values)'),assert.isFalse(intersects(f,{top:2,bottom:3,left:0,right:1}),'no intersect')}),suite('when verticalAlign is top',function(){test('element is aligned to the positionTarget top',function(){c.verticalAlign='top',c.refit();var f=c.getBoundingClientRect();assert.equal(f.top,b.top,'top ok'),assert.equal(f.height,d.height,'no cropping')}),test('element is aligned to the positionTarget top without overlapping it',function(){a.style.width='10px',a.style.height='10px',b=a.getBoundingClientRect(),c.verticalAlign='top',c.noOverlap=!0,c.refit();var f=c.getBoundingClientRect();assert.isFalse(intersects(f,b),'no overlap'),assert.equal(f.height,d.height,'no cropping')}),test('element margin is considered as offset',function(){c.verticalAlign='top',c.style.marginTop='10px',c.refit();var f=c.getBoundingClientRect();assert.equal(f.top,b.top+10,'top ok'),assert.equal(f.height,d.height,'no cropping'),c.style.marginTop='-10px',c.refit(),f=c.getBoundingClientRect(),assert.equal(f.top,b.top-10,'top ok'),assert.equal(f.height,d.height,'no cropping')}),test('verticalOffset is applied',function(){c.verticalAlign='top',c.verticalOffset=10,c.refit();var f=c.getBoundingClientRect();assert.equal(f.top,b.top+10,'top ok'),assert.equal(f.height,d.height,'no cropping')}),test('element is kept in viewport',function(){c.verticalAlign='top',c.verticalOffset=-1e3,c.refit();var f=c.getBoundingClientRect();assert.equal(f.top,0,'top in viewport'),assert.isTrue(f.height<d.height,'reduced size')}),test('negative verticalOffset does not crop element',function(){a.style.top=window.innerHeight-50+'px',c.verticalAlign='top',c.verticalOffset=-10,c.refit();var f=c.getBoundingClientRect();assert.equal(f.top,window.innerHeight-60,'top ok'),assert.equal(f.bottom,window.innerHeight,'bottom ok')}),test('max-height is updated',function(){a.style.top='-10px',c.verticalAlign='top',c.refit();var f=c.getBoundingClientRect();assert.equal(f.top,0,'top ok'),assert.isBelow(f.height,d.height,'height ok')}),test('min-height is preserved: element is displayed even if partially',function(){a.style.top='-10px',c.verticalAlign='top',c.style.minHeight=d.height+'px',c.refit();var f=c.getBoundingClientRect();assert.equal(f.top,0,'top ok'),assert.equal(f.height,d.height,'min-height ok'),assert.isTrue(intersects(f,e),'partially visible')}),test('dynamicAlign will prefer bottom align if it minimizes the cropping',function(){a.style.top='-10px',b=a.getBoundingClientRect(),c.verticalAlign='top',c.dynamicAlign=!0,c.refit();var f=c.getBoundingClientRect();assert.equal(f.bottom,b.bottom,'bottom ok'),assert.equal(f.height,d.height,'no cropping')})}),suite('when verticalAlign is bottom',function(){test('element is aligned to the positionTarget bottom',function(){c.verticalAlign='bottom',c.refit();var f=c.getBoundingClientRect();assert.equal(f.bottom,b.bottom,'bottom ok'),assert.equal(f.height,d.height,'no cropping')}),test('element is aligned to the positionTarget bottom without overlapping it',function(){c.verticalAlign='bottom',c.noOverlap=!0,c.refit();var f=c.getBoundingClientRect();assert.isFalse(intersects(f,b),'no overlap'),assert.equal(f.height,d.height,'no cropping')}),test('element margin is considered as offset',function(){c.verticalAlign='bottom',c.style.marginBottom='10px',c.refit();var f=c.getBoundingClientRect();assert.equal(f.bottom,b.bottom-10,'bottom ok'),assert.equal(f.height,d.height,'no cropping'),c.style.marginBottom='-10px',c.refit(),f=c.getBoundingClientRect(),assert.equal(f.bottom,b.bottom+10,'bottom ok'),assert.equal(f.height,d.height,'no cropping')}),test('verticalOffset is applied',function(){c.verticalAlign='bottom',c.verticalOffset=10,c.refit();var f=c.getBoundingClientRect();assert.equal(f.bottom,b.bottom-10,'bottom ok'),assert.equal(f.height,d.height,'no cropping')}),test('element is kept in viewport',function(){c.verticalAlign='bottom',c.verticalOffset=1e3,c.refit();var f=c.getBoundingClientRect();assert.equal(f.top,0,'top in viewport'),assert.isTrue(f.height<d.height,'reduced size')}),test('element max-height is updated',function(){a.style.top=100-b.height+'px',c.verticalAlign='bottom',c.refit();var f=c.getBoundingClientRect();assert.equal(f.bottom,100,'bottom ok'),assert.equal(f.height,100,'height ok')}),test('min-height is preserved: element is displayed even if partially',function(){a.style.top=d.height-10-b.height+'px',c.verticalAlign='bottom',c.style.minHeight=d.height+'px',c.refit();var f=c.getBoundingClientRect();assert.equal(f.top,0,'top ok'),assert.equal(f.height,d.height,'min-height ok'),assert.isTrue(intersects(f,e),'partially visible')}),test('dynamicAlign will prefer top align if it minimizes the cropping',function(){a.style.top=window.innerHeight-d.height+'px',b=a.getBoundingClientRect(),c.verticalAlign='bottom',c.dynamicAlign=!0,c.refit();var f=c.getBoundingClientRect();assert.equal(f.top,b.top,'top ok'),assert.equal(f.height,d.height,'no cropping')})}),suite('when verticalAlign is auto',function(){test('element is aligned to the positionTarget top',function(){c.verticalAlign='auto',c.refit();var f=c.getBoundingClientRect();assert.equal(f.top,b.top,'auto aligned to top'),assert.equal(f.height,d.height,'no cropping')}),test('element is aligned to the positionTarget top without overlapping it',function(){a.style.width='10px',a.style.height='10px',b=a.getBoundingClientRect(),c.verticalAlign='auto',c.noOverlap=!0,c.refit();var f=c.getBoundingClientRect();assert.equal(f.height,d.height,'no cropping'),assert.isFalse(intersects(f,b),'no overlap')}),test('bottom is preferred to top if it diminishes the cropped area',function(){a.style.top='-10px',b=a.getBoundingClientRect(),c.verticalAlign='auto',c.refit();var f=c.getBoundingClientRect();assert.equal(f.bottom,b.bottom,'auto aligned to bottom'),assert.equal(f.height,d.height,'no cropping')}),test('bottom is preferred to top if it diminishes the cropped area, without overlapping positionTarget',function(){a.style.top='-10px',b=a.getBoundingClientRect(),c.verticalAlign='auto',c.noOverlap=!0,c.refit();var f=c.getBoundingClientRect();assert.equal(f.height,d.height,'no cropping'),assert.isFalse(intersects(f,b),'no overlap')})}),suite('when horizontalAlign is left',function(){test('element is aligned to the positionTarget left',function(){c.horizontalAlign='left',c.refit();var f=c.getBoundingClientRect();assert.equal(f.left,b.left,'left ok'),assert.equal(f.width,d.width,'no cropping')}),test('element is aligned to the positionTarget left without overlapping it',function(){a.style.width='10px',b=a.getBoundingClientRect(),c.horizontalAlign='left',c.noOverlap=!0,c.refit();var f=c.getBoundingClientRect();assert.isFalse(intersects(f,b),'no overlap'),assert.equal(f.width,d.width,'no cropping')}),test('element margin is considered as offset',function(){c.horizontalAlign='left',c.style.marginLeft='10px',c.refit();var f=c.getBoundingClientRect();assert.equal(f.left,b.left+10,'left ok'),assert.equal(f.width,d.width,'no cropping'),c.style.marginLeft='-10px',c.refit(),f=c.getBoundingClientRect(),assert.equal(f.left,b.left-10,'left ok'),assert.equal(f.width,d.width,'no cropping')}),test('horizontalOffset is applied',function(){c.horizontalAlign='left',c.horizontalOffset=10,c.refit();var f=c.getBoundingClientRect();assert.equal(f.left,b.left+10,'left ok'),assert.equal(f.width,d.width,'no cropping')}),test('element is kept in viewport',function(){c.horizontalAlign='left',c.horizontalOffset=-1e3,c.refit();var f=c.getBoundingClientRect();assert.equal(f.left,0,'left in viewport'),assert.isTrue(f.width<d.width,'reduced size')}),test('negative horizontalOffset does not crop element',function(){a.style.left=window.innerWidth-50+'px',c.horizontalAlign='left',c.horizontalOffset=-10,c.refit();var f=c.getBoundingClientRect();assert.equal(f.left,window.innerWidth-60,'left ok'),assert.equal(f.right,window.innerWidth,'right ok')}),test('element max-width is updated',function(){a.style.left='-10px',c.horizontalAlign='left',c.refit();var f=c.getBoundingClientRect();assert.equal(f.left,0,'left ok'),assert.isBelow(f.width,d.width,'width ok')}),test('min-width is preserved: element is displayed even if partially',function(){a.style.left='-10px',c.style.minWidth=d.width+'px',c.horizontalAlign='left',c.refit();var f=c.getBoundingClientRect();assert.equal(f.left,0,'left ok'),assert.equal(f.width,d.width,'min-width ok'),assert.isTrue(intersects(f,e),'partially visible')}),test('dynamicAlign will prefer right align if it minimizes the cropping',function(){a.style.left='-10px',b=a.getBoundingClientRect(),c.horizontalAlign='left',c.dynamicAlign=!0,c.refit();var f=c.getBoundingClientRect();assert.equal(f.right,b.right,'right ok'),assert.equal(f.height,d.height,'no cropping')})}),suite('when horizontalAlign is right',function(){test('element is aligned to the positionTarget right',function(){c.horizontalAlign='right',c.refit();var f=c.getBoundingClientRect();assert.equal(f.right,b.right,'right ok'),assert.equal(f.width,d.width,'no cropping')}),test('element is aligned to the positionTarget right without overlapping it',function(){a.style.left=d.width+'px',b=a.getBoundingClientRect(),c.horizontalAlign='right',c.noOverlap=!0,c.refit();var f=c.getBoundingClientRect();assert.isFalse(intersects(f,b),'no overlap'),assert.equal(f.width,d.width,'no cropping')}),test('element margin is considered as offset',function(){c.horizontalAlign='right',c.style.marginRight='10px',c.refit();var f=c.getBoundingClientRect();assert.equal(f.right,b.right-10,'right ok'),assert.equal(f.width,d.width,'no cropping'),c.style.marginRight='-10px',c.refit(),f=c.getBoundingClientRect(),assert.equal(f.right,b.right+10,'right ok'),assert.equal(f.width,d.width,'no cropping')}),test('horizontalOffset is applied',function(){c.horizontalAlign='right',c.horizontalOffset=10,c.refit();var f=c.getBoundingClientRect();assert.equal(f.right,b.right-10,'right ok'),assert.equal(f.width,d.width,'no cropping')}),test('element is kept in viewport',function(){c.horizontalAlign='right',c.horizontalOffset=1e3,c.refit();var f=c.getBoundingClientRect();assert.equal(f.left,0,'left in viewport'),assert.isTrue(f.width<d.width,'reduced width')}),test('element max-width is updated',function(){a.style.left=100-b.width+'px',c.horizontalAlign='right',c.refit();var f=c.getBoundingClientRect();assert.equal(f.right,100,'right ok'),assert.equal(f.width,100,'width ok')}),test('min-width is preserved: element is displayed even if partially',function(){a.style.left=d.width-10-b.width+'px',c.horizontalAlign='right',c.style.minWidth=d.width+'px',c.refit();var f=c.getBoundingClientRect();assert.equal(f.left,0,'left ok'),assert.equal(f.width,d.width,'min-width ok'),assert.isTrue(intersects(f,e),'partially visible')}),test('dynamicAlign will prefer left align if it minimizes the cropping',function(){a.style.left=window.innerWidth-d.width+'px',b=a.getBoundingClientRect(),c.horizontalAlign='right',c.dynamicAlign=!0,c.refit();var f=c.getBoundingClientRect();assert.equal(f.left,b.left,'left ok'),assert.equal(f.height,d.height,'no cropping')})}),suite('when horizontalAlign is auto',function(){test('element is aligned to the positionTarget left',function(){c.horizontalAlign='auto',c.refit();var f=c.getBoundingClientRect();assert.equal(f.left,b.left,'auto aligned to left'),assert.equal(f.width,d.width,'no cropping')}),test('element is aligned to the positionTarget left without overlapping positionTarget',function(){a.style.left=d.width+'px',b=a.getBoundingClientRect(),c.horizontalAlign='auto',c.noOverlap=!0,c.refit();var f=c.getBoundingClientRect();assert.equal(f.width,d.width,'no cropping'),assert.isFalse(intersects(f,b),'no overlap')}),test('right is preferred to left if it diminishes the cropped area',function(){a.style.left='-10px',b=a.getBoundingClientRect(),c.horizontalAlign='auto',c.refit();var f=c.getBoundingClientRect();assert.equal(f.right,b.right,'auto aligned to right'),assert.equal(f.width,d.width,'no cropping')}),test('right is preferred to left if it diminishes the cropped area, without overlapping positionTarget',function(){a.style.width='10px',b=a.getBoundingClientRect(),c.horizontalAlign='auto',c.noOverlap=!0,c.refit();var f=c.getBoundingClientRect();assert.equal(f.width,d.width,'no cropping'),assert.isFalse(intersects(f,b),'no overlap')})}),suite('prefer horizontal overlap to vertical overlap',function(){setup(function(){c.noOverlap=!0,c.dynamicAlign=!0,a.style.top=d.height+'px',a.style.left=d.width+'px',a.style.width='10px',a.style.height='10px',b=a.getBoundingClientRect()}),test('top-left aligns to target bottom-left',function(){c.verticalAlign='top',c.horizontalAlign='left',c.refit();var f=c.getBoundingClientRect();assert.equal(f.left,b.left,'left ok'),assert.equal(f.top,b.bottom,'top ok')}),test('top-right aligns to target bottom-right',function(){c.verticalAlign='top',c.horizontalAlign='right',c.refit();var f=c.getBoundingClientRect();assert.equal(f.right,b.right,'right ok'),assert.equal(f.top,b.bottom,'top ok')}),test('bottom-left aligns to target top-left',function(){c.verticalAlign='bottom',c.horizontalAlign='left',c.refit();var f=c.getBoundingClientRect();assert.equal(f.left,b.left,'left ok'),assert.equal(f.bottom,b.top,'bottom ok')}),test('bottom-right aligns to target top-right',function(){c.verticalAlign='bottom',c.horizontalAlign='right',c.refit();var f=c.getBoundingClientRect();assert.equal(f.right,b.right,'right ok'),assert.equal(f.bottom,b.top,'bottom ok')})})});</script></body></html>