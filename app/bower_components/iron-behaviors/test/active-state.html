<!DOCTYPE html><html><head><title>active-state</title>
    <script>if (!window.customElements) { document.write('<!--'); }</script>
    <script type="text/javascript" src="../../webcomponentsjs/custom-elements-es5-adapter.js"></script>
    <!--! do not remove -->
<script src="../../webcomponentsjs/webcomponents-lite.js"></script><script src="../../web-component-tester/browser.js"></script><script src="../../iron-test-helpers/mock-interactions.js"></script><link rel="import" href="test-elements.html"><link rel="import" href="../../paper-input/paper-input.html"></head><body><test-fixture id="TrivialActiveState"><template><test-button></test-button></template></test-fixture><test-fixture id="ToggleActiveState"><template><test-button toggles=""></test-button></template></test-fixture><test-fixture id="ButtonWithNativeInput"><template><test-light-dom><input id="input"></test-light-dom></template></test-fixture><test-fixture id="ButtonWithPaperInput"><template><test-light-dom><paper-input id="input"></paper-input></test-light-dom></template></test-fixture><script>suite('active-state',function(){var a;setup(function(){a=fixture('TrivialActiveState')}),suite('active state with toggles attribute',function(){setup(function(){a=fixture('ToggleActiveState')}),suite('when down',function(){test('is pressed',function(){MockInteractions.down(a),expect(a.hasAttribute('pressed')).to.be.eql(!0)})}),suite('when clicked',function(){test('is activated',function(b){MockInteractions.downAndUp(a,function(){try{expect(a.hasAttribute('active')).to.be.eql(!0),expect(a.hasAttribute('aria-pressed')).to.be.eql(!0),expect(a.getAttribute('aria-pressed')).to.be.eql('true'),b()}catch(c){b(c)}})}),test('is deactivated by a subsequent click',function(b){MockInteractions.downAndUp(a,function(){MockInteractions.downAndUp(a,function(){try{expect(a.hasAttribute('active')).to.be.eql(!1),expect(a.hasAttribute('aria-pressed')).to.be.eql(!0),expect(a.getAttribute('aria-pressed')).to.be.eql('false'),b()}catch(c){b(c)}})})}),test('the correct aria attribute is set',function(b){a.ariaActiveAttribute='aria-checked',MockInteractions.downAndUp(a,function(){try{expect(a.hasAttribute('active')).to.be.eql(!0),expect(a.hasAttribute('aria-checked')).to.be.eql(!0),expect(a.getAttribute('aria-checked')).to.be.eql('true'),b()}catch(c){b(c)}})}),test('the aria attribute is updated correctly',function(b){a.ariaActiveAttribute='aria-checked',MockInteractions.downAndUp(a,function(){try{expect(a.hasAttribute('active')).to.be.eql(!0),expect(a.hasAttribute('aria-checked')).to.be.eql(!0),expect(a.getAttribute('aria-checked')).to.be.eql('true'),a.ariaActiveAttribute='aria-pressed',expect(a.hasAttribute('aria-checked')).to.be.eql(!1),expect(a.hasAttribute('aria-pressed')).to.be.eql(!0),expect(a.getAttribute('aria-pressed')).to.be.eql('true'),b()}catch(c){b(c)}})})}),suite('on blur',function(){test('the pressed property becomes false',function(){MockInteractions.focus(a),MockInteractions.down(a),expect(a.hasAttribute('pressed')).to.be.eql(!0),MockInteractions.blur(a),expect(a.hasAttribute('pressed')).to.be.eql(!1)})})}),suite('without toggles attribute',function(){suite('when mouse is down',function(){test('does not get an active attribute',function(){expect(a.hasAttribute('active')).to.be.eql(!1),MockInteractions.down(a),expect(a.hasAttribute('active')).to.be.eql(!1)})}),suite('when mouse is up',function(){test('does not get an active attribute',function(){MockInteractions.down(a),expect(a.hasAttribute('active')).to.be.eql(!1),MockInteractions.up(a),expect(a.hasAttribute('active')).to.be.eql(!1)})})}),suite('when space is pressed',function(){test('triggers a click event',function(b){a.addEventListener('click',function(){b()}),MockInteractions.pressSpace(a)}),test('only triggers click after the key is released',function(b){var c=!1;a.addEventListener('keyup',function(){c=!0}),a.addEventListener('click',function(){try{expect(c).to.be.eql(!0),b()}catch(d){b(d)}}),MockInteractions.pressSpace(a)})}),suite('when enter is pressed',function(){test('triggers a click event',function(b){a.addEventListener('click',function(){b()}),MockInteractions.pressEnter(a)}),test('only triggers click before the key is released',function(b){var c=!1;a.addEventListener('keyup',function(){c=!0}),a.addEventListener('click',function(){try{expect(c).to.be.eql(!1),b()}catch(d){b(d)}}),MockInteractions.pressEnter(a)})}),suite('nested native input inside button',function(){test('space in light child input does not trigger a button click event',function(b){var c=fixture('ButtonWithNativeInput'),d=c.querySelector('#input'),f=sinon.spy();c.addEventListener('click',f),d.focus(),MockInteractions.pressSpace(d),Polymer.Base.async(function(){expect(f.callCount).to.be.equal(0),b()},1)}),test('space in button triggers a button click event',function(b){var c=fixture('ButtonWithNativeInput'),d=c.querySelector('#input'),f=sinon.spy();c.addEventListener('click',f),MockInteractions.pressSpace(c),Polymer.Base.async(function(){Polymer.Base.async(function(){expect(f.callCount).to.be.equal(1),b()},1)},1)})}),suite('nested paper-input inside button',function(){test('space in light child input does not trigger a button click event',function(b){var c=fixture('ButtonWithPaperInput'),d=c.querySelector('#input'),f=sinon.spy();c.addEventListener('click',f),d.focus(),MockInteractions.pressSpace(d),Polymer.Base.async(function(){expect(f.callCount).to.be.equal(0),b()},1)}),test('space in button triggers a button click event',function(b){var c=fixture('ButtonWithPaperInput'),d=c.querySelector('#input'),f=sinon.spy();c.addEventListener('click',f),MockInteractions.pressSpace(c),Polymer.Base.async(function(){Polymer.Base.async(function(){expect(f.callCount).to.be.equal(1),b()},1)},1)})})});</script></body></html>