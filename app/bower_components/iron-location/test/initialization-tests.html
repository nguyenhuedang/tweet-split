<!DOCTYPE html><html><head><meta charset="utf-8"><title></title>
    <script>if (!window.customElements) { document.write('<!--'); }</script>
    <script type="text/javascript" src="../../webcomponentsjs/custom-elements-es5-adapter.js"></script>
    <!--! do not remove -->
<script src="../../webcomponentsjs/webcomponents-lite.js"></script><script src="../../web-component-tester/browser.js"></script><script src="../../test-fixture/test-fixture-mocha.js"></script><link rel="import" href="../../polymer/polymer.html"><link rel="import" href="../../promise-polyfill/promise-polyfill.html"><link rel="import" href="../../test-fixture/test-fixture.html"><link rel="import" href="../iron-location.html"></head><body><script>'use strict';function getIframe(){return new Promise(function(a,b){var c=document.createElement('iframe'),d=getMessageMatching(c,function(g){return'ready'===g.type});c.src='./initialization-iframe.html',document.body.appendChild(c),c.addEventListener('error',b),d.then(function(){a(c)},b)})}function onMessage(a,b){var c=function(g){g.source===a.contentWindow&&b(g.data)};return window.addEventListener('message',c,!1),function(){window.removeEventListener('message',c)}}function getMessageMatching(a,b){var c=function(){},d=new Promise(function(g){c=onMessage(a,function(j){b(j)&&g(j)})});return d.then(c,c),d}function getUrl(a){var b=getMessageMatching(a,function(d){return'urlQueryResponse'===d.type}),c=function(){};return b.then(function(){return new Promise(function(d){c=onMessage(a,d)})}),b.then(c,c),a.contentWindow.postMessage({type:'urlQuery'},'*'),b}function timePasses(a){return new Promise(function(b){window.setTimeout(function(){b()},a)})}suite('<iron-location>\'s initialization',function(){var a,b;setup(function(){return getIframe().then(function(g){a=g,getMessageMatching(a,function(j){return'error'===j.type}).then(function(j){b=j.error})})}),teardown(function(){a&&document.body.removeChild(a);var g=b;if(a=null,b=null,g)throw new Error('Error message from contained iframe: '+g)});['default-before','attached-before','ready-before','default-after','attached-after','ready-after','default-below','attached-below','ready-below','default-above','attached-above','ready-above','default-container','attached-container','ready-container'].forEach(function(g){test('the url takes priority in '+g+' initialization',function(){return getUrl(a).then(function(h){return expect(h.search).to.be.eq(''),a.contentWindow.postMessage({type:'appendBody',tagName:g},'*'),timePasses(60).then(function(){return getUrl(a)})}).then(function(h){expect(h.search).to.be.eq('')})})});['timeout-before','timeout-after','timeout-below','timeout-above','timeout-container'].forEach(function(g){test('the url does not take priority in '+g+' initialization',function(){return getUrl(a).then(function(h){return expect(h.search).to.be.eq(''),a.contentWindow.postMessage({type:'appendBody',tagName:g},'*'),timePasses(60).then(function(){return getUrl(a)})}).then(function(h){expect(h.search).to.be.eq('?on-timeout')})})})});</script></body></html>